# 快速参考卡片

## 🚀 常用命令

### 运行应用
```bash
# 开发环境
python PDF_Rename_Operation.py

# 生产环境
PDF_Rename_Operation.exe
```

### 版本管理
```python
# 使用Config类更新版本号
from auto_updater.config import get_config

config = get_config()
config.update_current_version("2.1.0")  # 更新版本号
print(f"当前版本: {config.current_version}")  # 获取版本号

# 验证版本比较
is_newer = config.is_newer_version("v2.1.0", "2.0.0")
```

### 测试工具
```bash
# 测试自动更新功能
python test_update.py

# 测试PDF处理功能
python -c "from pdf_processor import PDFProcessor; print('OK')"
```

### 打包和签名
```bash
# 打包应用
python 打包工具.py

# 数字签名
python PDF签名工具.py
```

---

## ⚙️ 关键配置

### 主配置文件：updater_config.json
```json
{
  "repository": {
    "owner": "your-username",        // 【修改】GitHub用户名
    "repo": "your-repo-name"         // 【修改】仓库名称
  },
  "version": {
    "current": "2.0.0",             // 【同步】当前版本号
    "auto_check_enabled": true      // 自动更新检查
  }
}
```

### 测试方法常用模板
```
# 玩具类产品
Total Lead Content Test;Total Cadmium Content Test;Nickel Release Test;Small Part Test;Sharp Edge Test

# 首饰类产品
Total Lead Content Test;Total Cadmium Content Test;Nickel Release Test;Tensile Strength Test

# 服装类产品
Total Lead Content Test;Total Cadmium Content Test;Flammability Test
```

---

## 📄 PDF重命名工作流

### 标准流程
1. **选择文件** → 选择要处理的PDF文件
2. **输入方法** → 填入测试方法（分号分隔）
3. **测试验证** → 点击"测试方法"验证提取逻辑
4. **批量处理** → 确认无误后点击"重命名"
5. **查看报告** → 检查生成的Excel报告

### 文件命名格式
```
[Sampling ID]-[Report No]-[结论].pdf
示例：ABC-2024-001-TR2024001-Pass.pdf
```

### 输出目录
默认：`C:\Users\chen-fr\Desktop\test\1\`
报告：`PDF重命名报告_YYYYMMDD_HHMMSS.xlsx`

---

## 🔄 自动更新流程

### 检查更新
- **启动时**：自动检查（每30天）
- **手动检查**：菜单 → 更新 → 检查更新

### 更新步骤
1. 发现新版本 → 确认更新
2. 下载文件 → 显示进度
3. 创建备份 → 安全保护
4. 替换程序 → 自动完成
5. 重启应用 → 使用新版本

### 配置要点
- **GitHub仓库**：必须正确配置owner和repo
- **版本号**：updater_config.json中version.current字段
- **网络连接**：需要访问GitHub API

---

## 🆘 常见问题快速解决

### PDF处理问题
| 问题 | 解决方案 |
|------|---------|
| 无法提取Sampling ID | 检查PDF内容，确认包含"Sampling ID:"字样 |
| 测试方法识别不准 | 调整测试方法名称，与PDF中表述一致 |
| 文件重命名失败 | 检查文件权限，确认目标文件名不冲突 |

### 更新问题
| 问题 | 解决方案 |
|------|---------|
| 检查更新失败 | 检查网络连接和GitHub仓库配置 |
| 下载中断 | 重新下载，支持断点续传 |
| 更新失败 | 查看backup目录，手动恢复备份 |

### 配置问题
| 问题 | 解决方案 |
|------|---------|
| 版本号不一致 | 检查updater_config.json中version.current字段 |
| 配置文件格式错误 | 使用JSON验证工具检查格式 |
| 仓库配置错误 | 修改updater_config.json中的owner/repo |
| 签名配置错误 | 检查signature_config.json配置 |

---

## 📋 检查清单

### 使用前检查
- [ ] PDF文件准备就绪
- [ ] 测试方法列表确认
- [ ] 输出目录存在且有写权限
- [ ] 网络连接正常（如需更新功能）

### 处理后检查
- [ ] 文件重命名正确
- [ ] Excel报告生成成功
- [ ] 异常文件已单独处理
- [ ] 备份文件已保留（如需要）

---

## 🔧 开发者快速参考

### 模块导入
```python
from auto_updater import AutoUpdater, UpdateError
from auto_updater.config import get_config
from pdf_processor import PDFProcessor
from signing_tool import SigningTool
```

### 核心类
```python
# 自动更新器
updater = AutoUpdater(parent=None)
has_update = updater.check_for_updates()

# 配置管理
config = get_config()
current_version = config.current_version

# PDF处理器
processor = PDFProcessor()
result = processor.process_pdf(file_path, test_methods)

# 数字签名工具
signing_tool = SigningTool()
success, message = signing_tool.sign_file("app.exe")
```

### 错误处理
```python
try:
    # 业务逻辑
    pass
except UpdateError as e:
    print(f"更新错误: {e}")
except Exception as e:
    print(f"其他错误: {e}")
```

---

## 📞 获取帮助

### 📚 详细文档
- **自动更新功能**：[自动更新功能使用教程.md](./自动更新功能使用教程.md)
- **PDF重命名功能**：[PDF重命名业务功能使用教程.md](./PDF重命名业务功能使用教程.md)
- **配置文件说明**：[配置文件说明.md](./配置文件说明.md)
- **项目总览**：[项目总览和使用指南.md](./项目总览和使用指南.md)

### 🛠️ 诊断工具
```bash
# 完整功能测试
python test_update.py

# PDF处理功能测试
python -c "from pdf_processor import PDFProcessor; print('PDF处理模块正常')"

# 配置验证
python -c "from auto_updater.config import get_config; print(f'版本: {get_config().current_version}')"
```

### 📝 问题反馈
1. 查看详细教程文档
2. 运行诊断工具
3. 收集错误日志
4. GitHub Issues提交

---

*最后更新：2025-10-27 | 版本：v2.0.0*