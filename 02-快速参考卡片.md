# å¿«é€Ÿå‚è€ƒå¡ç‰‡

## ğŸš€ å¸¸ç”¨å‘½ä»¤

### è¿è¡Œåº”ç”¨
```bash
# å¼€å‘ç¯å¢ƒ
python PDF_Rename_Operation.py

# ç”Ÿäº§ç¯å¢ƒ
PDF_Rename_Operation.exe
```

### ç‰ˆæœ¬ç®¡ç†
```python
# ä½¿ç”¨Configç±»æ›´æ–°ç‰ˆæœ¬å·
from auto_updater.config import get_config

config = get_config()
config.update_current_version("2.1.0")  # æ›´æ–°ç‰ˆæœ¬å·
print(f"å½“å‰ç‰ˆæœ¬: {config.current_version}")  # è·å–ç‰ˆæœ¬å·

# éªŒè¯ç‰ˆæœ¬æ¯”è¾ƒ
is_newer = config.is_newer_version("v2.1.0", "2.0.0")
```

### æµ‹è¯•å·¥å…·
```bash
# æµ‹è¯•è‡ªåŠ¨æ›´æ–°åŠŸèƒ½
python test_update.py

# æµ‹è¯•PDFå¤„ç†åŠŸèƒ½
python -c "from pdf_processor import PDFProcessor; print('OK')"
```

### æ‰“åŒ…å’Œç­¾å
```bash
# æ‰“åŒ…åº”ç”¨
python æ‰“åŒ…å·¥å…·.py

# æ•°å­—ç­¾å
python PDFç­¾åå·¥å…·.py

# ç­¾åé…ç½®æµ‹è¯•
python test_signing_config.py

# ç­¾ååŠŸèƒ½æµ‹è¯•
python test_actual_signing.py
```

---

## âš™ï¸ å…³é”®é…ç½®

### ä¸»é…ç½®æ–‡ä»¶ï¼šupdater_config.json
```json
{
  "repository": {
    "owner": "your-username",        // ã€ä¿®æ”¹ã€‘GitHubç”¨æˆ·å
    "repo": "your-repo-name"         // ã€ä¿®æ”¹ã€‘ä»“åº“åç§°
  },
  "version": {
    "current": "2.0.0",             // ã€åŒæ­¥ã€‘å½“å‰ç‰ˆæœ¬å·
    "auto_check_enabled": true      // è‡ªåŠ¨æ›´æ–°æ£€æŸ¥
  }
}
```

### æµ‹è¯•æ–¹æ³•å¸¸ç”¨æ¨¡æ¿
```
# ç©å…·ç±»äº§å“
Total Lead Content Test;Total Cadmium Content Test;Nickel Release Test;Small Part Test;Sharp Edge Test

# é¦–é¥°ç±»äº§å“
Total Lead Content Test;Total Cadmium Content Test;Nickel Release Test;Tensile Strength Test

# æœè£…ç±»äº§å“
Total Lead Content Test;Total Cadmium Content Test;Flammability Test
```

### ğŸ” æ•°å­—ç­¾åé…ç½® (æ™ºèƒ½åŠ è½½ç³»ç»Ÿ)

#### æ¨èé…ç½®ï¼šPythoné…ç½®æ–‡ä»¶
**æ–‡ä»¶ä½ç½®**: `code_signer/examples/project_config.py`

```python
# åŸºæœ¬é…ç½®
CONFIG.enabled = True
CONFIG.default_certificate = "pdf_rename_operation"
CONFIG.timestamp_server = "http://timestamp.digicert.com"
CONFIG.hash_algorithm = "sha256"

# é¡¹ç›®è¯ä¹¦é…ç½®
pdf_cert = CertificateConfig(
    name="pdf_rename_operation",
    sha1="144ac4069565211ab67d25a9d6d33af0e18e511e",
    subject="CN=PDF_Rename_Operation...",
    issuer="CN=TUVSUD-IssuingCA..."
)
CONFIG.add_certificate(pdf_cert)
```

#### å…¼å®¹é…ç½®ï¼šJSONé…ç½®æ–‡ä»¶
**æ–‡ä»¶ä½ç½®**: `signature_config.json`

```json
{
  "signature": {
    "enabled": true,
    "default_certificate": "pdf_rename_operation",
    "timestamp_server": "http://timestamp.digicert.com",
    "hash_algorithm": "sha256",
    "certificates": {
      "pdf_rename_operation": {
        "name": "PDF_Rename_Operationè¯ä¹¦",
        "sha1": "144ac4069565211ab67d25a9d6d33af0e18e511e"
      }
    }
  }
}
```

#### é…ç½®åŠ è½½ä¼˜å…ˆçº§
1. æŒ‡å®šé…ç½®è·¯å¾„
2. `code_signer/examples/project_config.py` (æ¨è)
3. `signature_config.json` (å…¼å®¹)
4. å†…ç½®é»˜è®¤é…ç½®

#### ç¼–ç¨‹ä½¿ç”¨
```python
# æ™ºèƒ½åŠ è½½é…ç½® (æ¨è)
from code_signer.config_loader import load_signing_config
config = load_signing_config()

# ä¼ ç»Ÿæ–¹å¼ (å…¼å®¹)
from signing_tool import SigningTool
tool = SigningTool()  # è‡ªåŠ¨åŠ è½½é…ç½®
```

---

## ğŸ“„ PDFé‡å‘½åå·¥ä½œæµ

### æ ‡å‡†æµç¨‹
1. **é€‰æ‹©æ–‡ä»¶** â†’ é€‰æ‹©è¦å¤„ç†çš„PDFæ–‡ä»¶
2. **è¾“å…¥æ–¹æ³•** â†’ å¡«å…¥æµ‹è¯•æ–¹æ³•ï¼ˆåˆ†å·åˆ†éš”ï¼‰
3. **æµ‹è¯•éªŒè¯** â†’ ç‚¹å‡»"æµ‹è¯•æ–¹æ³•"éªŒè¯æå–é€»è¾‘
4. **æ‰¹é‡å¤„ç†** â†’ ç¡®è®¤æ— è¯¯åç‚¹å‡»"é‡å‘½å"
5. **æŸ¥çœ‹æŠ¥å‘Š** â†’ æ£€æŸ¥ç”Ÿæˆçš„ExcelæŠ¥å‘Š

### æ–‡ä»¶å‘½åæ ¼å¼
```
[Sampling ID]-[Report No]-[ç»“è®º].pdf
ç¤ºä¾‹ï¼šABC-2024-001-TR2024001-Pass.pdf
```

### è¾“å‡ºç›®å½•
é»˜è®¤ï¼š`C:\Users\chen-fr\Desktop\test\1\`
æŠ¥å‘Šï¼š`PDFé‡å‘½åæŠ¥å‘Š_YYYYMMDD_HHMMSS.xlsx`

---

## ğŸ”„ è‡ªåŠ¨æ›´æ–°æµç¨‹

### æ£€æŸ¥æ›´æ–°
- **å¯åŠ¨æ—¶**ï¼šè‡ªåŠ¨æ£€æŸ¥ï¼ˆæ¯30å¤©ï¼‰
- **æ‰‹åŠ¨æ£€æŸ¥**ï¼šèœå• â†’ æ›´æ–° â†’ æ£€æŸ¥æ›´æ–°

### æ›´æ–°æ­¥éª¤
1. å‘ç°æ–°ç‰ˆæœ¬ â†’ ç¡®è®¤æ›´æ–°
2. ä¸‹è½½æ–‡ä»¶ â†’ æ˜¾ç¤ºè¿›åº¦
3. åˆ›å»ºå¤‡ä»½ â†’ å®‰å…¨ä¿æŠ¤
4. æ›¿æ¢ç¨‹åº â†’ è‡ªåŠ¨å®Œæˆ
5. é‡å¯åº”ç”¨ â†’ ä½¿ç”¨æ–°ç‰ˆæœ¬

### é…ç½®è¦ç‚¹
- **GitHubä»“åº“**ï¼šå¿…é¡»æ­£ç¡®é…ç½®ownerå’Œrepo
- **ç‰ˆæœ¬å·**ï¼šupdater_config.jsonä¸­version.currentå­—æ®µ
- **ç½‘ç»œè¿æ¥**ï¼šéœ€è¦è®¿é—®GitHub API

---

## ğŸ†˜ å¸¸è§é—®é¢˜å¿«é€Ÿè§£å†³

### PDFå¤„ç†é—®é¢˜
| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|---------|
| æ— æ³•æå–Sampling ID | æ£€æŸ¥PDFå†…å®¹ï¼Œç¡®è®¤åŒ…å«"Sampling ID:"å­—æ · |
| æµ‹è¯•æ–¹æ³•è¯†åˆ«ä¸å‡† | è°ƒæ•´æµ‹è¯•æ–¹æ³•åç§°ï¼Œä¸PDFä¸­è¡¨è¿°ä¸€è‡´ |
| æ–‡ä»¶é‡å‘½åå¤±è´¥ | æ£€æŸ¥æ–‡ä»¶æƒé™ï¼Œç¡®è®¤ç›®æ ‡æ–‡ä»¶åä¸å†²çª |

### æ›´æ–°é—®é¢˜
| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|---------|
| æ£€æŸ¥æ›´æ–°å¤±è´¥ | æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒGitHubä»“åº“é…ç½® |
| ä¸‹è½½ä¸­æ–­ | é‡æ–°ä¸‹è½½ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼  |
| æ›´æ–°å¤±è´¥ | æŸ¥çœ‹backupç›®å½•ï¼Œæ‰‹åŠ¨æ¢å¤å¤‡ä»½ |

### é…ç½®é—®é¢˜
| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|---------|
| ç‰ˆæœ¬å·ä¸ä¸€è‡´ | æ£€æŸ¥auto_updater/config_constants.pyä¸­ç‰ˆæœ¬å· |
| é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ | ä½¿ç”¨JSONéªŒè¯å·¥å…·æ£€æŸ¥æ ¼å¼ |
| ä»“åº“é…ç½®é”™è¯¯ | ä¿®æ”¹config_constants.pyä¸­çš„owner/repo |

### ğŸ” æ•°å­—ç­¾åé—®é¢˜
| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|---------|
| åˆå§‹åŒ–ç­¾åå·¥å…·å¤±è´¥ | è¿è¡Œ`python test_signing_config.py`æ£€æŸ¥é…ç½® |
| è¯ä¹¦SHA1ä¸èƒ½ä¸ºç©º | ç¡®ä¿project_config.pyä¸­è¯ä¹¦sha1å­—æ®µæœ‰å€¼ |
| æ‰¾ä¸åˆ°ç­¾åå·¥å…· | å®‰è£…Windows 10 SDKï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°PowerShell |
| SigningConfigå¯¹è±¡æ²¡æœ‰max_retrieså±æ€§ | ä½¿ç”¨`config.policies.max_retries`è®¿é—® |
| é…ç½®åŠ è½½å¤±è´¥ | æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•å¤šç§é…ç½®æº |
| ç­¾åéªŒè¯å¤±è´¥ | è¿è¡Œ`certutil -store MY`æ£€æŸ¥ç³»ç»Ÿä¸­çš„è¯ä¹¦ |

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### ä½¿ç”¨å‰æ£€æŸ¥
- [ ] PDFæ–‡ä»¶å‡†å¤‡å°±ç»ª
- [ ] æµ‹è¯•æ–¹æ³•åˆ—è¡¨ç¡®è®¤
- [ ] è¾“å‡ºç›®å½•å­˜åœ¨ä¸”æœ‰å†™æƒé™
- [ ] ç½‘ç»œè¿æ¥æ­£å¸¸ï¼ˆå¦‚éœ€æ›´æ–°åŠŸèƒ½ï¼‰

### å¤„ç†åæ£€æŸ¥
- [ ] æ–‡ä»¶é‡å‘½åæ­£ç¡®
- [ ] ExcelæŠ¥å‘Šç”ŸæˆæˆåŠŸ
- [ ] å¼‚å¸¸æ–‡ä»¶å·²å•ç‹¬å¤„ç†
- [ ] å¤‡ä»½æ–‡ä»¶å·²ä¿ç•™ï¼ˆå¦‚éœ€è¦ï¼‰

### ğŸ” æ•°å­—ç­¾åæ£€æŸ¥æ¸…å•
#### ç­¾åå‰æ£€æŸ¥
- [ ] ç­¾åé…ç½®æ–‡ä»¶å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
- [ ] è¯ä¹¦SHA1æŒ‡çº¹é…ç½®æœ‰æ•ˆ
- [ ] ç­¾åå·¥å…·å¯ç”¨ï¼ˆsigntool/PowerShellï¼‰
- [ ] ç›®æ ‡æ–‡ä»¶å­˜åœ¨ä¸”å¯è®¿é—®

#### ç­¾ååæ£€æŸ¥
- [ ] æ–‡ä»¶ç­¾åæˆåŠŸå®Œæˆ
- [ ] ç­¾åè®°å½•å·²ç”Ÿæˆ
- [ ] ç­¾åéªŒè¯é€šè¿‡
- [ ] æ—¶é—´æˆ³æœåŠ¡æ­£å¸¸

---

## ğŸ”§ å¼€å‘è€…å¿«é€Ÿå‚è€ƒ

### æ¨¡å—å¯¼å…¥
```python
from auto_updater import AutoUpdater, UpdateError
from auto_updater.config import get_config
from pdf_processor import PDFProcessor
from signing_tool import SigningTool

# æ–°çš„ç­¾åæ¨¡å—
from code_signer.config_loader import load_signing_config
from code_signer import CodeSigner
```

### æ ¸å¿ƒç±»
```python
# è‡ªåŠ¨æ›´æ–°å™¨
updater = AutoUpdater(parent=None)
has_update = updater.check_for_updates()

# é…ç½®ç®¡ç†
config = get_config()
current_version = config.current_version

# PDFå¤„ç†å™¨
processor = PDFProcessor()
result = processor.process_pdf(file_path, test_methods)

# æ•°å­—ç­¾åå·¥å…·
signing_tool = SigningTool()
success, message = signing_tool.sign_file("app.exe")

# æ–°çš„ç­¾åå™¨ (æ¨è)
config = load_signing_config()
signer = CodeSigner(config)
success, message = signer.sign_file("app.exe")

# é…ç½®éªŒè¯
errors = config.validate()
if not errors:
    print("é…ç½®éªŒè¯é€šè¿‡")
```

### é”™è¯¯å¤„ç†
```python
try:
    # ä¸šåŠ¡é€»è¾‘
    pass
except UpdateError as e:
    print(f"æ›´æ–°é”™è¯¯: {e}")
except Exception as e:
    print(f"å…¶ä»–é”™è¯¯: {e}")
```

---

## ğŸ“ è·å–å¸®åŠ©

### ğŸ“š è¯¦ç»†æ–‡æ¡£
- **è‡ªåŠ¨æ›´æ–°åŠŸèƒ½**ï¼š[è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ä½¿ç”¨æ•™ç¨‹.md](./è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ä½¿ç”¨æ•™ç¨‹.md)
- **PDFé‡å‘½ååŠŸèƒ½**ï¼š[PDFé‡å‘½åä¸šåŠ¡åŠŸèƒ½ä½¿ç”¨æ•™ç¨‹.md](./PDFé‡å‘½åä¸šåŠ¡åŠŸèƒ½ä½¿ç”¨æ•™ç¨‹.md)
- **é…ç½®æ–‡ä»¶è¯´æ˜**ï¼š[é…ç½®æ–‡ä»¶è¯´æ˜.md](./é…ç½®æ–‡ä»¶è¯´æ˜.md)
- **é¡¹ç›®æ€»è§ˆ**ï¼š[é¡¹ç›®æ€»è§ˆå’Œä½¿ç”¨æŒ‡å—.md](./é¡¹ç›®æ€»è§ˆå’Œä½¿ç”¨æŒ‡å—.md)

### ğŸ› ï¸ è¯Šæ–­å·¥å…·
```bash
# å®Œæ•´åŠŸèƒ½æµ‹è¯•
python test_update.py

# PDFå¤„ç†åŠŸèƒ½æµ‹è¯•
python -c "from pdf_processor import PDFProcessor; print('PDFå¤„ç†æ¨¡å—æ­£å¸¸')"

# é…ç½®éªŒè¯
python -c "from auto_updater.config import get_config; print(f'ç‰ˆæœ¬: {get_config().current_version}')"
```

### ğŸ“ é—®é¢˜åé¦ˆ
1. æŸ¥çœ‹è¯¦ç»†æ•™ç¨‹æ–‡æ¡£
2. è¿è¡Œè¯Šæ–­å·¥å…·
3. æ”¶é›†é”™è¯¯æ—¥å¿—
4. GitHub Issuesæäº¤

---

*æœ€åæ›´æ–°ï¼š2025-10-27 | ç‰ˆæœ¬ï¼šv2.0.0*