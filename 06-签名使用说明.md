# PDF重命名工具 - 数字签名使用说明

## 证书信息

- **证书名称**: PDF_Rename_Operation
- **颁发机构**: TUVSUD-IssuingCA
- **SHA1哈希**: `144ac4069565211ab67d25a9d6d33af0e18e511e`
- **有效期**: 2025/10/15 - 2027/10/15
- **密钥状态**: 私钥不可导出

## 使用方法

### 一键签名（推荐）

```bash
python PDF签名工具.py
```

**功能特点：**
- ✅ 自动验证PDF_Rename_Operation证书
- ✅ 自动查找PDF_Rename_Operation.exe文件
- ✅ 一键签名，无需配置
- ✅ 自动验证签名结果
- ✅ 生成详细签名记录

## 工作流程

1. **证书验证**: 检查PDF_Rename_Operation证书是否在系统中，代码```certutil -user -store My```
2. **文件查找**: 自动查找需要签名的exe文件
3. **签名操作**: 使用TUVSUD证书进行签名
4. **结果验证**: 验证签名是否成功
5. **记录保存**: 生成签名记录文件

## 预期文件路径

工具会自动查找以下位置的exe文件：
- `dist/PDF_Rename_Operation.exe`
- `PDF重命名工具_便携版/PDF_Rename_Operation.exe`
- `PDF_Rename_Operation.exe`

## 验证签名

### 方法1：文件属性
1. 右键点击exe文件
2. 选择"属性"
3. 查看"数字签名"选项卡
4. 确认显示TUVSUD证书信息

### 方法2：命令行验证
```cmd
signtool verify /pa "dist/PDF_Rename_Operation.exe"
```

## 故障排除

### 问题：未找到PDF_Rename_Operation证书
**解决方案：**
确保证书已安装到当前用户的个人证书存储中

### 问题：未找到signtool.exe
**解决方案：**
安装Windows SDK，选择"Windows SDK Signing Tools"

### 问题：签名失败
**解决方案：**
1. 检查网络连接（时间戳服务器）
2. 确保证书权限正确
3. 确认文件未被占用

## 签名记录

签名成功后，会生成 `*_签名记录.json` 文件，包含：
- 签名文件路径
- 证书详细信息
- 签名时间
- 签名状态
- 工具版本

## 推荐使用流程

1. **生成exe文件**: 运行打包工具
2. **一键签名**: 运行 `python PDF签名工具.py`
3. **验证结果**: 检查exe文件属性

---

**版本**: 1.0
**更新时间**: 2025-10-16
**适用证书**: PDF_Rename_Operation (TUVSUD颁发)