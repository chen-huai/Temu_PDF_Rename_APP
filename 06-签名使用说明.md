# PDFé‡å‘½åå·¥å…· - æ•°å­—ç­¾åä½¿ç”¨è¯´æ˜

## æ¶æ„æ¦‚è¿°

æœ¬é¡¹ç›®é‡‡ç”¨**é€šç”¨ç­¾åæ¨¡å— + é¡¹ç›®ä¸“ç”¨é…ç½®**çš„æ¶æ„ï¼š

- **é€šç”¨æ¨¡å—**: `signing_tool.py` - å¯å¤ç”¨çš„ä»£ç ç­¾åæ ¸å¿ƒ
- **é…ç½®æ–‡ä»¶**: `signature_config.json` - ç»Ÿä¸€çš„ç­¾åé…ç½®ç®¡ç†
- **é¡¹ç›®å…¥å£**: `PDFç­¾åå·¥å…·.py` - é¡¹ç›®ä¸“ç”¨çš„ç­¾åç•Œé¢

## é…ç½®æ–‡ä»¶è¯´æ˜

### signature_config.json ç»“æ„

```json
{
  "signature": {
    "enabled": true,
    "default_certificate": "pdf_rename_operation",
    "timestamp_server": "http://timestamp.digicert.com",
    "certificates": {
      "pdf_rename_operation": {
        "name": "PDF_Rename_Operationè¯ä¹¦",
        "sha1": "144ac4069565211ab67d25a9d6d33af0e18e511e",
        "subject": "CN=PDF_Rename_Operation...",
        "issuer": "CN=TUVSUD-IssuingCA..."
      }
    },
    "signing_tools": { ... },
    "policies": { ... }
  }
}
```

## PDFé‡å‘½åå·¥å…·è¯ä¹¦ä¿¡æ¯

- **è¯ä¹¦åç§°**: PDF_Rename_Operation
- **é¢å‘æœºæ„**: TUVSUD-IssuingCA
- **SHA1å“ˆå¸Œ**: `144ac4069565211ab67d25a9d6d33af0e18e511e`
- **æœ‰æ•ˆæœŸ**: 2025/10/15 - 2027/10/15
- **å¯†é’¥çŠ¶æ€**: ç§é’¥ä¸å¯å¯¼å‡º

## ä½¿ç”¨æ–¹æ³•

### ä¸€é”®ç­¾åï¼ˆæ¨èï¼‰

```bash
python PDFç­¾åå·¥å…·.py
```

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**
- âœ… åŸºäºé€šç”¨ç­¾åæ¨¡å—ï¼Œé…ç½®é©±åŠ¨
- âœ… è‡ªåŠ¨éªŒè¯PDF_Rename_Operationè¯ä¹¦
- âœ… è‡ªåŠ¨æŸ¥æ‰¾PDF_Rename_Operation.exeæ–‡ä»¶
- âœ… ä¸€é”®ç­¾åï¼Œæ— éœ€é…ç½®
- âœ… è‡ªåŠ¨éªŒè¯ç­¾åç»“æœ
- âœ… ç”Ÿæˆè¯¦ç»†ç­¾åè®°å½•

## é€šç”¨ç­¾åæ¨¡å—ä½¿ç”¨

### åŸºæœ¬ç”¨æ³•

```python
from signing_tool import SigningTool

# åˆå§‹åŒ–ç­¾åå·¥å…·
tool = SigningTool("signature_config.json")

# ç­¾åæ–‡ä»¶
success, message = tool.sign_file("app.exe", "certificate_name")

# éªŒè¯ç­¾å
success, message = tool.verify_signature("app.exe")
```

### ä¾¿æ·å‡½æ•°

```python
from signing_tool import sign_file, verify_file_signature

# å¿«é€Ÿç­¾å
success, message = sign_file("app.exe")

# å¿«é€ŸéªŒè¯
success, message = verify_file_signature("app.exe")
```

### æ‰¹é‡ç­¾å

```python
# æ‰¹é‡ç­¾åç›®å½•ä¸­çš„æ‰€æœ‰exeæ–‡ä»¶
results = tool.batch_sign("dist/", "certificate_name")
for file_path, (success, message) in results.items():
    print(f"{file_path}: {message}")
```

## å·¥ä½œæµç¨‹

1. **è¯ä¹¦éªŒè¯**: æ£€æŸ¥PDF_Rename_Operationè¯ä¹¦æ˜¯å¦åœ¨ç³»ç»Ÿä¸­ï¼Œä»£ç ```certutil -user -store My```
2. **æ–‡ä»¶æŸ¥æ‰¾**: è‡ªåŠ¨æŸ¥æ‰¾éœ€è¦ç­¾åçš„exeæ–‡ä»¶
3. **ç­¾åæ“ä½œ**: ä½¿ç”¨TUVSUDè¯ä¹¦è¿›è¡Œç­¾å
4. **ç»“æœéªŒè¯**: éªŒè¯ç­¾åæ˜¯å¦æˆåŠŸ
5. **è®°å½•ä¿å­˜**: ç”Ÿæˆç­¾åè®°å½•æ–‡ä»¶

## é¢„æœŸæ–‡ä»¶è·¯å¾„

å·¥å…·ä¼šè‡ªåŠ¨æŸ¥æ‰¾ä»¥ä¸‹ä½ç½®çš„exeæ–‡ä»¶ï¼š
- `dist/PDF_Rename_Operation.exe`
- `PDFé‡å‘½åå·¥å…·_ä¾¿æºç‰ˆ/PDF_Rename_Operation.exe`
- `PDF_Rename_Operation.exe`

## éªŒè¯ç­¾å

### æ–¹æ³•1ï¼šæ–‡ä»¶å±æ€§
1. å³é”®ç‚¹å‡»exeæ–‡ä»¶
2. é€‰æ‹©"å±æ€§"
3. æŸ¥çœ‹"æ•°å­—ç­¾å"é€‰é¡¹å¡
4. ç¡®è®¤æ˜¾ç¤ºTUVSUDè¯ä¹¦ä¿¡æ¯

### æ–¹æ³•2ï¼šå‘½ä»¤è¡ŒéªŒè¯
```cmd
signtool verify /pa "dist/PDF_Rename_Operation.exe"
```

## æ•…éšœæ’é™¤

### é—®é¢˜ï¼šæœªæ‰¾åˆ°PDF_Rename_Operationè¯ä¹¦
**è§£å†³æ–¹æ¡ˆï¼š**
ç¡®ä¿è¯ä¹¦å·²å®‰è£…åˆ°å½“å‰ç”¨æˆ·çš„ä¸ªäººè¯ä¹¦å­˜å‚¨ä¸­

### é—®é¢˜ï¼šæœªæ‰¾åˆ°signtool.exe
**è§£å†³æ–¹æ¡ˆï¼š**
å®‰è£…Windows SDKï¼Œé€‰æ‹©"Windows SDK Signing Tools"

### é—®é¢˜ï¼šç­¾åå¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆæ—¶é—´æˆ³æœåŠ¡å™¨ï¼‰
2. ç¡®ä¿è¯ä¹¦æƒé™æ­£ç¡®
3. ç¡®è®¤æ–‡ä»¶æœªè¢«å ç”¨

## ç­¾åè®°å½•

ç­¾åæˆåŠŸåï¼Œä¼šç”Ÿæˆ `*_ç­¾åè®°å½•.json` æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- ç­¾åæ–‡ä»¶è·¯å¾„
- è¯ä¹¦è¯¦ç»†ä¿¡æ¯
- ç­¾åæ—¶é—´
- ç­¾åçŠ¶æ€
- å·¥å…·ç‰ˆæœ¬

## é¡¹ç›®å¤ç”¨æŒ‡å—

### å¤åˆ¶åˆ°å…¶ä»–é¡¹ç›®

1. **å¤åˆ¶æ ¸å¿ƒæ–‡ä»¶**ï¼š
   ```
   your_project/
   â”œâ”€â”€ signing_tool.py           # é€šç”¨ç­¾åæ¨¡å—
   â””â”€â”€ signature_config.json      # ç­¾åé…ç½®æ–‡ä»¶
   ```

2. **ä¿®æ”¹é…ç½®æ–‡ä»¶**ï¼š
   ```json
   {
     "signature": {
       "default_certificate": "your_certificate",
       "certificates": {
         "your_certificate": {
           "name": "æ‚¨çš„è¯ä¹¦åç§°",
           "sha1": "æ‚¨çš„è¯ä¹¦SHA1å“ˆå¸Œ",
           "subject": "è¯ä¹¦ä¸»ä½“ä¿¡æ¯",
           "issuer": "è¯ä¹¦é¢å‘è€…ä¿¡æ¯"
         }
       }
     }
   }
   ```

3. **ä½¿ç”¨é€šç”¨æ¨¡å—**ï¼š
   ```python
   from signing_tool import SigningTool

   tool = SigningTool("signature_config.json")
   success, message = tool.sign_file("your_app.exe", "your_certificate")
   ```

### æ”¯æŒçš„ç­¾åå·¥å…·

- **signtool.exe** (Windows SDK) - ä¼˜å…ˆçº§1
- **PowerShell Set-AuthenticodeSignature** - ä¼˜å…ˆçº§2
- **osslsigncode** - ä¼˜å…ˆçº§3

### é«˜çº§é…ç½®

```json
{
  "signature": {
    "policies": {
      "verify_before_sign": true,      // ç­¾åå‰éªŒè¯è¯ä¹¦
      "backup_before_sign": false,     // ç­¾åå‰å¤‡ä»½æ–‡ä»¶
      "auto_retry": true,               // è‡ªåŠ¨é‡è¯•
      "max_retries": 3,                 // æœ€å¤§é‡è¯•æ¬¡æ•°
      "record_signing_history": true    // è®°å½•ç­¾åå†å²
    },
    "file_paths": {
      "search_patterns": ["*.exe", "build/*.exe"],
      "exclude_patterns": ["*.tmp.exe", "*_unsigned.exe"],
      "record_directory": "./signature_records"
    },
    "output": {
      "verbose": true,                 // è¯¦ç»†è¾“å‡º
      "save_records": true,             // ä¿å­˜è®°å½•
      "create_log_file": true          // åˆ›å»ºæ—¥å¿—æ–‡ä»¶
    }
  }
}
```

## æ¨èä½¿ç”¨æµç¨‹

1. **ç”Ÿæˆexeæ–‡ä»¶**: è¿è¡Œæ‰“åŒ…å·¥å…·
2. **ä¸€é”®ç­¾å**: è¿è¡Œ `python PDFç­¾åå·¥å…·.py`
3. **éªŒè¯ç»“æœ**: æ£€æŸ¥exeæ–‡ä»¶å±æ€§

## æ›´æ–°æ—¥å¿—

### v2.0 (2025-10-27)
- âœ¨ é‡æ„ä¸ºé€šç”¨ç­¾åæ¨¡å—æ¶æ„
- âœ¨ æ”¯æŒé…ç½®é©±åŠ¨çš„å¤šè¯ä¹¦ç®¡ç†
- âœ¨ å¢å¼ºçš„ç­¾åç­–ç•¥å’Œæ‰¹é‡å¤„ç†
- âœ¨ å®Œæ•´çš„é¡¹ç›®å¤ç”¨æ”¯æŒ

### v1.0 (2025-10-16)
- ğŸ¯ åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒPDF_Rename_Operationè¯ä¹¦ç­¾å

---

**ç‰ˆæœ¬**: 2.0
**æ›´æ–°æ—¶é—´**: 2025-10-27
**æ¶æ„**: é€šç”¨ç­¾åæ¨¡å— + é…ç½®é©±åŠ¨
**é€‚ç”¨è¯ä¹¦**: æ”¯æŒå¤šç§ä»£ç ç­¾åè¯ä¹¦