# PDF重命名工具 - 项目总览和使用指南

## 项目简介

PDF重命名工具是专门为**Temu产品测试报告**设计的智能重命名工具，集成了完整的**企业级自动更新系统**和**智能PDF处理功能**。

### 核心特性
- ✅ **智能信息提取**：自动识别Sampling ID、Report No、测试结果
- ✅ **智能字段映射**：三层匹配机制，确保字段名准确匹配
- ✅ **批量文件处理**：支持多文件同时处理，提高工作效率
- ✅ **企业级更新系统**：基于GitHub Releases的自动更新机制
- ✅ **Excel报告生成**：详细的处理结果统计和分析
- ✅ **增强调试功能**：详细的字段匹配过程日志
- ✅ **用户友好界面**：基于PyQt5的直观操作界面
- ✅ **数字签名支持**：TUVSUD证书签名，确保软件安全性

---

## 📁 项目文件结构

```
项目根目录/
├── 📄 主要程序文件
│   ├── PDF_Rename_Operation.py          # 主应用程序入口
│   ├── pdf_processor.py                 # PDF处理核心引擎
│   ├── PDF_Rename_UI.py                 # 界面定义（自动生成）
│   └── chicon_rc.py                     # 资源文件
│
├── 📁 auto_updater/                     # 自动更新模块
│   ├── __init__.py                      # 主入口和AutoUpdater类
│   ├── github_client.py                 # GitHub API客户端
│   ├── download_manager.py              # 文件下载管理器
│   ├── backup_manager.py                # 备份管理器
│   ├── update_executor.py               # 更新执行器
│   ├── config.py                        # Config类统一配置管理
│   ├── settings.py                      # 设置管理
│   └── error_handler.py                 # 错误处理
│
├── ⚙️ 配置文件
│   ├── auto_updater/config_constants.py  # 主配置常量（Python）
│   ├── update_state.json                # 更新状态文件
│   ├── code_signer/examples/project_config.py  # 数字签名配置（推荐）
│   ├── signature_config.json            # 数字签名配置（兼容）
│   └── requirements.txt                 # Python依赖包列表

├── 🔐 数字签名模块
│   ├── code_signer/                     # 现代化签名核心模块
│   │   ├── __init__.py                  # 模块入口
│   │   ├── config.py                    # 配置类定义
│   │   ├── config_loader.py             # 智能配置加载器
│   │   ├── core.py                      # 签名核心逻辑
│   │   ├── utils.py                     # 工具函数
│   │   ├── examples/                    # 配置示例
│   │   └── README.md                    # 模块文档
│   ├── signing_tool.py                  # 传统签名工具（兼容）
│   └── PDF签名工具.py                   # 项目专用签名工具
│
├── 🔧 工具脚本
│   ├── test_update.py                   # 更新功能测试脚本
│   ├── 打包工具.py                       # 应用打包脚本
│   ├── test_signing_config.py           # 签名配置测试工具
│   └── test_actual_signing.py           # 签名功能测试工具
│
├── 📚 使用教程
│   ├── 01-项目总览和使用指南.md         # 本文档
│   ├── 02-快速参考卡片.md                # 常用命令快速参考
│   ├── 03-PDF重命名业务功能使用教程.md   # PDF处理业务功能教程
│   ├── 04-配置文件说明.md                # 配置文件详细说明
│   ├── 05-自动更新功能使用教程.md        # 自动更新功能详细教程
│   ├── 06-签名使用说明.md                # 数字签名使用说明
│   ├── 07-版本更新清单.md                # 版本发布记录
│   └── 文档索引.md                       # 文档导航索引
│
├── 📋 文档文件
│   └── CLAUDE.md                        # 项目总体文档
│
└── 📁 模块文档
    ├── PDF_Rename_Operation/            # 主应用程序模块文档
    ├── pdf_processor/                   # PDF处理引擎模块文档
    ├── PDF_Rename_UI/                   # 界面定义模块文档
    ├── PDF签名工具/                     # 数字签名工具文档
    └── 打包工具/                        # 打包工具模块文档
```

---

## 🚀 快速开始

### 第一步：环境准备

#### 1.1 系统要求
- **操作系统**：Windows 7/8/10/11（推荐Windows 10+）
- **Python版本**：3.7+（开发环境）
- **内存要求**：至少4GB RAM
- **网络要求**：访问GitHub（用于自动更新）

#### 1.2 安装依赖
```bash
# 安装必要的Python包
pip install -r requirements.txt
```

### 第二步：运行应用程序

#### 2.1 开发环境运行
```bash
# 直接运行Python脚本
python PDF_Rename_Operation.py
```

#### 2.2 生产环境运行
```bash
# 运行打包后的可执行文件
PDF_Rename_Operation.exe
```

### 第三步：基本使用流程

1. **选择PDF文件** → 2. **输入测试方法** → 3. **测试方法验证** → 4. **批量重命名** → 5. **查看Excel报告**

📖 **详细教程**：[PDF重命名业务功能使用教程.md](./PDF重命名业务功能使用教程.md#三详细使用步骤)

🔧 **快速参考**：[快速参考卡片.md](./快速参考卡片.md#pdf重命名工作流)

---

## 📖 详细教程指南

### 🔄 自动更新功能
📖 **完整教程**：[自动更新功能使用教程.md](./自动更新功能使用教程.md)

**功能特点**：
- GitHub Releases集成
- 自动版本检查
- 安全备份恢复
- 用户友好界面

**关键配置**：
- `auto_updater/config_constants.py`：主配置常量（Python）
- `update_state.json`：更新状态文件
- GitHub仓库配置

### 🔐 数字签名功能
📖 **完整教程**：[签名使用说明.md](./06-签名使用说明.md)

**功能特点**：
- 智能配置加载系统
- 多签名工具支持 (signtool/PowerShell/osslsigncode)
- TUVSUD证书签名
- 配置验证和错误处理
- 向后兼容性

**配置系统**：
- **推荐**: `code_signer/examples/project_config.py` (Python配置)
- **兼容**: `signature_config.json` (JSON配置)
- **智能加载**: 自动选择最佳配置
- **配置验证**: 自动检查配置完整性

### 📄 PDF重命名业务功能
📖 **完整教程**：[PDF重命名业务功能使用教程.md](./PDF重命名业务功能使用教程.md)

**功能特点**：
- 智能信息提取
- 批量文件处理
- 测试模式验证
- Excel报告生成

**关键要素**：
- 测试方法配置
- 文件命名规则
- 结果报告分析

### ⚙️ 配置文件管理
📖 **详细说明**：[配置文件说明.md](./04-配置文件说明.md)

**配置系统架构**：
- **Python常量配置**: `auto_updater/config_constants.py` (应用配置)
- **智能签名配置**: `code_signer/examples/project_config.py` (推荐)
- **兼容JSON配置**: `signature_config.json` (向后兼容)
- **状态管理**: `update_state.json` (更新状态)

**配置特点**：
- 类型安全的Python配置
- 智能配置加载和验证
- 多级配置优先级
- 自动错误处理和降级

---

## 🛠️ 开发者工具

### 测试工具
```bash
# 测试自动更新功能
python test_update.py


# 验证配置功能
python -c "from auto_updater.config import get_config; print(f'版本: {get_config().current_version}')"

# 测试签名功能
python -c "from signing_tool import SigningTool; print('签名模块正常')"
```

### 打包工具
```bash
# 打包应用程序
python 打包工具.py

# 数字签名
python PDF签名工具.py
```

### 模块测试
```bash
# 测试PDF处理功能
python -c "from pdf_processor import PDFProcessor; print('PDF processor OK')"

# 测试更新功能
python -c "from auto_updater import AutoUpdater; print('Auto updater OK')"
```

---

## 🔧 配置指南

### GitHub仓库配置
编辑 `updater_config.json`：
```json
{
  "repository": {
    "owner": "your-username",           // 【修改】您的GitHub用户名
    "repo": "your-repo-name"            // 【修改】您的仓库名称
  }
}
```

### 版本管理
```bash
# 更新版本号（所有相关文件会同步更新）
python update_version.py 2.1.0

# 验证版本一致性
python update_version.py --verify
```

### 输出目录配置
默认输出目录：`C:\Users\chen-fr\Desktop\test\1\`

可在 `PDF_Rename_Operation.py` 中修改：
```python
DEFAULT_OUTPUT_DIR = "D:\Your\Custom\Directory"
```

---

## 📋 使用检查清单

### ✅ 运行前检查
- [ ] Python环境已安装（开发环境）
- [ ] 依赖包已安装
- [ ] 配置文件完整
- [ ] GitHub仓库配置正确
- [ ] 版本号一致

### ✅ 功能测试
- [ ] 应用程序正常启动
- [ ] 文件选择功能正常
- [ ] PDF处理功能正常
- [ ] 自动更新检查正常
- [ ] Excel报告生成正常

### ✅ 配置验证
- [ ] `updater_config.json` 格式正确
- [ ] `update_state.json` 文件可写
- [ ] `signature_config.json` 配置正确
- [ ] 网络连接正常
- [ ] 输出目录可写

---

## 🆘 故障排除

### 常见问题解决

#### 1. 应用程序无法启动
- 检查Python环境和依赖包
- 确认文件权限正确
- 查看错误日志

#### 2. PDF处理失败
- 确认PDF文件格式正确
- 检查文件是否加密
- 验证测试方法配置

#### 3. 自动更新失败
- 检查网络连接
- 验证GitHub仓库配置
- 查看更新日志

#### 4. 配置文件错误
- 使用配置验证工具
- 检查JSON格式
- 确认版本号一致

### 获取帮助
1. **查看详细教程**：参考专门的使用教程文档
2. **运行测试工具**：使用内置的诊断工具
3. **查看日志文件**：检查应用程序日志
4. **GitHub Issues**：在项目仓库提交问题

---

## 📈 版本历史

### 当前版本：v3.0.0
- ✅ 完整的自动更新系统
- ✅ 智能PDF信息提取
- ✅ 智能字段映射功能（三层匹配机制）
- ✅ 增强调试和日志功能
- ✅ Excel报告生成
- ✅ 企业级功能特性

### 主要更新记录
详细版本历史请查看：[版本更新清单.md](./版本更新清单.md)

---

## 🎯 最佳实践

### 文件管理
- 按批次或类型组织PDF文件
- 定期清理临时文件和备份
- 保持配置文件同步

### 质量控制
- 使用测试模式验证提取逻辑
- 抽样检查处理结果
- 定期验证配置一致性

### 性能优化
- 分批处理大量文件
- 定期清理磁盘空间
- 保持系统资源充足

---

## 📞 技术支持

### 联系方式
- **项目仓库**：https://github.com/chen-huai/Temu_PDF_Rename_APP
- **问题反馈**：通过GitHub Issues提交
- **技术文档**：查看项目文档目录

### 支持信息
- **当前版本**：v3.0.0
- **最后更新**：2025-10-30
- **文档版本**：2.0
- **主要更新**：新增智能字段映射功能

---

## 🔮 未来规划

### 功能增强
- [ ] 支持更多PDF格式
- [ ] 增加更多测试方法模板
- [ ] 优化处理性能
- [ ] 增加多语言支持

### 系统改进
- [ ] Web界面版本
- [ ] 云端处理能力
- [ ] 移动端支持
- [ ] API接口

---

**感谢使用PDF重命名工具！**

如需更多帮助，请参考详细教程文档或联系技术支持。

---

*文档版本：2.0 | 最后更新：2025-10-30 | 适用版本：v3.0.0+ | 主要更新：新增智能字段映射功能*